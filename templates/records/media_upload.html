{% extends 'layouts/base.html' %}
{% block title %}Subir archivo{% endblock %}
{% block content %}
<h2>Subir archivo multimedia</h2>
<form method="post" enctype="multipart/form-data" action="{{ action }}" id="uploadForm">
    {{ form.csrf_token }}
    <div class="mb-3">{{ form.source_type.label }} {{ form.source_type(class="form-select", id='sourceSelect') }}</div>
    <div class="mb-3">{{ form.category.label }} {{ form.category(class="form-select") }}</div>
    <div class="mb-3">{{ form.title.label }} {{ form.title(class="form-control") }}</div>
    <div class="mb-3">{{ form.description.label }} {{ form.description(class="form-control") }}</div>
    <div class="mb-3" id="fileField">{{ form.file.label }} {{ form.file(class="form-control") }}</div>
    <div class="mb-3 d-none" id="urlField">{{ form.url.label }} {{ form.url(class="form-control") }}</div>
    {{ form.submit(class="btn btn-success") }}
    <a href="{{ url_for('multimedia.list_media') }}" class="btn btn-secondary">Cancelar</a>
</form>
<script>
    const sourceSel = document.getElementById('sourceSelect');
    const fileDiv = document.getElementById('fileField');
    const urlDiv = document.getElementById('urlField');
    function toggleFields() {
        const isFile = sourceSel.value === 'FILE';
        fileDiv.classList.toggle('d-none', !isFile);
        urlDiv.classList.toggle('d-none', isFile);
    }
    sourceSel.addEventListener('change', toggleFields);
    document.addEventListener('DOMContentLoaded', toggleFields);
</script>
{% endblock %}
